# Open Short URL

> **å¼·å¤§çš„è‡ªæ¶çŸ­ç¶²å€æœå‹™ï¼Œæä¾›é€²éšåˆ†æèˆ‡éš±ç§å„ªå…ˆè¨­è¨ˆ**

å°‡å†—é•·çš„ç¶²å€è½‰æ›ç‚ºç°¡çŸ­æ˜“è¨˜çš„é€£çµï¼ŒåŒæ™‚å®Œå…¨æŒæ§æ‚¨çš„è³‡æ–™ã€‚é©åˆéœ€è¦é€²éšçŸ­ç¶²å€åŠŸèƒ½çš„ä¼æ¥­ã€è¡ŒéŠ·äººå“¡èˆ‡æ³¨é‡éš±ç§çš„ä½¿ç”¨è€…ã€‚

[![Deploy on Railway](https://railway.com/button.svg)](https://railway.com/deploy/EATit9?referralCode=EnYHPz&utm_medium=integration&utm_source=template&utm_campaign=generic)
[![npm version](https://img.shields.io/npm/v/@open-short-url/mcp.svg)](https://www.npmjs.com/package/@open-short-url/mcp)

[English](./README.md) | [ç¹é«”ä¸­æ–‡](#ç¹é«”ä¸­æ–‡)

---

## ç‚ºä»€éº¼é¸æ“‡ Open Short URLï¼Ÿ

### ğŸ” æ‚¨çš„è³‡æ–™ï¼Œæ‚¨åšä¸»

ä¸åŒæ–¼å•†æ¥­çŸ­ç¶²å€æœå‹™ï¼Œæ‚¨çš„è³‡æ–™ä¿å­˜åœ¨è‡ªå·±çš„ä¼ºæœå™¨ä¸Šã€‚æ²’æœ‰ç¬¬ä¸‰æ–¹è¿½è¹¤ã€æ²’æœ‰è³‡æ–™è²©å”®ï¼Œå®Œå…¨éš±ç§ã€‚

### ğŸ’° æˆæœ¬æ•ˆç›Šé«˜

æ“ºè„«æ˜‚è²´çš„ SaaS è¨‚é–±è²»ç”¨ï¼š

- ç„¡æœˆè²»æˆ–å¹´è²»
- ç„¡é€£çµæ•¸æˆ–é»æ“Šæ•¸é™åˆ¶
- ä¸€æ¬¡æ€§åŸºç¤è¨­æ–½æŠ•è³‡
- æ“´å±•è¦æ¨¡ç„¡éœ€å¢åŠ æˆæœ¬
- å¯é æ¸¬çš„ç‡Ÿé‹é–‹æ”¯

### ğŸ“Š å…¨é¢çš„åˆ†æåŠŸèƒ½

è¿½è¹¤æ¯ä¸€æ¬¡é»æ“Šï¼Œç²å¾—è©³ç´°æ´å¯Ÿï¼š

- å³æ™‚é»æ“Šè¿½è¹¤
- åœ°ç†ä½ç½®è³‡æ–™
- è£ç½®èˆ‡ç€è¦½å™¨åˆ†æ
- ä¾†æºè¿½è¹¤
- UTM è¡ŒéŠ·æ´»å‹•ç›£æ§

### ğŸ¨ ç™½æ¨™å®¢è£½åŒ–

å®Œå…¨å¯è‡ªè¨‚å“ç‰Œå½¢è±¡ï¼š

- è‡ªè¨‚ç¶²åŸŸæ”¯æ´
- å“ç‰ŒåŒ–å¯†ç¢¼é é¢
- å€‹äººåŒ– Logo èˆ‡é¡è‰²
- æ‚¨çš„å“ç‰Œï¼Œæ‚¨çš„é¢¨æ ¼

### ğŸ”’ é€²éšå®‰å…¨æ€§

- å¯†ç¢¼ä¿è­·ç¶²å€
- é€£çµåˆ°æœŸæ—¥è¨­å®š
- é€Ÿç‡é™åˆ¶é˜²æ¿«ç”¨
- Cloudflare Turnstile æ•´åˆ
- è§’è‰²æ¬Šé™æ§åˆ¶ï¼ˆç®¡ç†å“¡/ä½¿ç”¨è€…ï¼‰

### ğŸš€ ä¼æ¥­ç´šåŠŸèƒ½

- RESTful API èˆ‡å®Œæ•´æ–‡ä»¶
- API é‡‘é‘°ç®¡ç†ä¾¿æ–¼æ•´åˆ
- Webhook äº‹ä»¶é€šçŸ¥ï¼ˆHMAC-SHA256 ç°½åï¼‰
- A/B æ¸¬è©¦ï¼ˆç¶²å€è®Šé«”èˆ‡æµé‡åˆ†é…ï¼‰
- é€£çµçµ„åˆåŠŸèƒ½æ•´ç†ç¶²å€
- æ©Ÿå™¨äººåµæ¸¬èˆ‡éæ¿¾
- é›™å› ç´ é©—è­‰ï¼ˆ2FAï¼‰
- æ‰¹æ¬¡ç¶²å€ç®¡ç†
- QR Code ç”¢ç”Ÿå™¨
- å¤šèªè¨€æ”¯æ´ï¼ˆè‹±æ–‡ã€ç¹é«”ä¸­æ–‡ã€è‘¡è„ç‰™èªï¼‰
- **AI æ™ºèƒ½åŠŸèƒ½**ï¼š
  - å…§å»º AI èŠå¤©åŠ©æ‰‹ï¼ˆAnthropic Claudeã€OpenAI GPTã€Google Geminiï¼‰
  - Model Context Protocol (MCP) server æ”¯æ´å¤–éƒ¨ AI åŠ©æ‰‹

---

## ä¸»è¦åŠŸèƒ½

âœ¨ **æ™ºæ…§é€£çµç®¡ç†**

- è‡ªè¨‚çŸ­ç¢¼æˆ–è‡ªå‹•ç”¢ç”Ÿ
- æ ¹æ“šä½¿ç”¨é‡å‹•æ…‹èª¿æ•´çŸ­ç¢¼é•·åº¦
- é€£çµåˆ°æœŸèˆ‡æ’ç¨‹
- ç‹€æ…‹æ§åˆ¶ï¼ˆå•Ÿç”¨/åœç”¨ï¼‰

ğŸ“ˆ **å¼·å¤§çš„åˆ†æå·¥å…·**

- é»æ“Šçµ±è¨ˆå„€è¡¨æ¿
- æ™‚é–“åºåˆ—åˆ†æ
- åœ°ç†åˆ†å¸ƒ
- è£ç½®èˆ‡å¹³å°åˆ†æ
- UTM åƒæ•¸è¿½è¹¤

ğŸ”‘ **å½ˆæ€§é©—è­‰æ©Ÿåˆ¶**

- JWT ä½¿ç”¨è€…é©—è­‰
- API é‡‘é‘°æ”¯æ´ä¼ºæœå™¨æ•´åˆ
- é›™å› ç´ é©—è­‰
- å·¥ä½œéšæ®µç®¡ç†

ğŸ¯ **è¡ŒéŠ·å·¥å…·**

- æ•æ„Ÿé€£çµå¯†ç¢¼ä¿è­·
- UTM åƒæ•¸å»ºæ§‹å™¨
- QR Code ç”¢ç”Ÿ
- å“ç‰Œå®¢è£½åŒ–

âš¡ **é«˜æ•ˆèƒ½**

- é¸ç”¨ Redis å¿«å–åŠ é€Ÿè½‰å€
- PostgreSQL å¯é çš„è³‡æ–™å„²å­˜
- ç‚ºè¦æ¨¡åŒ–å„ªåŒ–

ğŸ“¦ **é€£çµçµ„ç¹”ç®¡ç†**

- å°‡ç¶²å€åˆ†çµ„ç‚ºä¸»é¡Œå¼çµ„åˆ/é›†åˆ
- è‡ªè¨‚çµ„åˆé¡è‰²èˆ‡åœ–ç¤º
- çµ„åˆçš„ç´¯è¨ˆé»æ“Šçµ±è¨ˆ
- çµ„åˆçš„ 7 å¤©é»æ“Šè¶¨å‹¢è¦–è¦ºåŒ–
- å–®ä¸€è¦–åœ–ç®¡ç†å¤šå€‹ç¶²å€
- å°å­˜èˆ‡é‚„åŸçµ„åˆ

ğŸ¤– **æ©Ÿå™¨äººåµæ¸¬**

- è‡ªå‹•è­˜åˆ¥æ©Ÿå™¨äººæµé‡
- åˆ†æä¸­éæ¿¾æ©Ÿå™¨äººé»æ“Š
- æ©Ÿå™¨äººé¡å‹åˆ†é¡ï¼ˆGooglebotã€Bingbot ç­‰ï¼‰
- ç¨ç«‹çš„æ©Ÿå™¨äººåˆ†æå„€è¡¨æ¿
- åˆ‡æ›é»æ“Šè¨˜éŒ„ä¸­çš„æ©Ÿå™¨äººé¡¯ç¤º

---

## éƒ¨ç½²

### ä¸€éµéƒ¨ç½²åˆ° Railway

æœ€å¿«çš„é–‹å§‹æ–¹å¼æ˜¯é€éä¸€éµéƒ¨ç½²åˆ° Railwayï¼š

[![Deploy on Railway](https://railway.com/button.svg)](https://railway.com/deploy/EATit9?referralCode=EnYHPz&utm_medium=integration&utm_source=template&utm_campaign=generic)

å°‡è‡ªå‹•å®Œæˆï¼š

- âœ… éƒ¨ç½²å‰ç«¯èˆ‡å¾Œç«¯æœå‹™
- âœ… é…ç½® PostgreSQL èˆ‡ Redis è³‡æ–™åº«
- âœ… è¨­å®šç’°å¢ƒè®Šæ•¸

**é‡è¦æé†’ï¼š**

- âš ï¸ è‡ªè¨‚ç¶²åŸŸéœ€è¦åœ¨ Railway è¨­å®šä¸­æ‰‹å‹•é…ç½®
- ğŸ” éƒ¨ç½²å®Œæˆå¾Œï¼Œè«‹ç«‹å³è®Šæ›´é è¨­ç®¡ç†å“¡å¯†ç¢¼

---

## Redis ä½¿ç”¨æŒ‡å—

Redis ç‚º**å®Œå…¨é¸ç”¨**ï¼Œç³»çµ±æœƒè‡ªå‹•å„ªé›…é™ç´šã€‚ç³»çµ±åœ¨æ²’æœ‰ Redis çš„æƒ…æ³ä¸‹ä¹Ÿèƒ½å®Œç¾é‹ä½œã€‚

### ğŸ¯ **å“ªäº›åŠŸèƒ½ä½¿ç”¨ Redisï¼Ÿ**

ç•¶ Redis å¯ç”¨æ™‚ï¼Œä»¥ä¸‹åŠŸèƒ½æœƒä½¿ç”¨å®ƒä¾†æå‡æ•ˆèƒ½ï¼š

1. **URL æŸ¥è©¢å¿«å–** - æ›´å¿«çš„é‡å®šå‘ï¼ˆ300ms â†’ 10-20msï¼‰
2. **Token é»‘åå–®** - å¤šå¯¦ä¾‹é–“å…±äº«ï¼ˆç™»å‡ºåŒæ­¥ï¼‰
3. **é€Ÿç‡é™åˆ¶** - è·¨å¯¦ä¾‹çš„æº–ç¢ºç¯€æµ

### ğŸ”„ **è‡ªå‹•é™ç´šï¼ˆæœªè¨­å®š Redisï¼‰**

å¦‚æœæœªè¨­å®š `REDIS_HOST`ï¼Œç³»çµ±æœƒè‡ªå‹•ä½¿ç”¨é™ç´šæ©Ÿåˆ¶ï¼š

| åŠŸèƒ½             | æ²’æœ‰ Redis æ™‚          | å½±éŸ¿                       |
| ---------------- | ---------------------- | -------------------------- |
| **URL å¿«å–**     | åœç”¨ï¼ˆç›´æ¥æŸ¥è©¢è³‡æ–™åº«ï¼‰ | é‡å®šå‘è¼ƒæ…¢ï¼Œè³‡æ–™åº«è² è¼‰è¼ƒé«˜ |
| **Token é»‘åå–®** | In-memory Map          | åƒ…é©ç”¨æ–¼å–®ä¸€å¯¦ä¾‹           |
| **é€Ÿç‡é™åˆ¶**     | In-memory Map          | åƒ…é©ç”¨æ–¼å–®ä¸€å¯¦ä¾‹           |

**ç³»çµ±ç‹€æ…‹ï¼š** åŠŸèƒ½å®Œæ•´ï¼Œåªæ˜¯é«˜æµé‡æ™‚è¼ƒæ…¢ã€‚

### âŒ **ç•¥é Redisï¼ˆ< æ¯æ—¥ 1 è¬æ¬¡é»æ“Šï¼‰**

**é©ç”¨æ–¼ï¼š**

- å€‹äººä½¿ç”¨æˆ–å°åœ˜éšŠå·¥å…·
- é–‹ç™¼/æ¸¬è©¦ç’°å¢ƒ
- é ç®—æœ‰é™çš„èµ·æ­¥éšæ®µ
- å–®ä¸€å¯¦ä¾‹éƒ¨ç½²

**æµé‡æŒ‡æ¨™ï¼š**

- æµé‡ï¼š< æ¯æ—¥ 10,000 æ¬¡é»æ“Šï¼ˆ~0.12 QPSï¼‰
- å³°å€¼ä¸¦ç™¼ï¼š< æ¯ç§’ 10 æ¬¡è«‹æ±‚

**å„ªé»ï¼š**

- âœ… é™ä½åŸºç¤è¨­æ–½æˆæœ¬ï¼ˆç´„ $5-10/æœˆï¼‰
- âœ… ç°¡åŒ–ç¶­è­·ï¼ˆå°‘ä¸€å€‹æœå‹™ï¼‰
- âœ… ç„¡éœ€ Redis è¨­å®š

### âœ… **ä½¿ç”¨ Redisï¼ˆ> æ¯æ—¥ 5 è¬æ¬¡é»æ“Šï¼‰**

**å»ºè­°ä½¿ç”¨æ–¼ï¼š**

- è¡ŒéŠ·æ´»å‹•å°è‡´æµé‡æ¿€å¢
- åˆ†æé é¢è¢«é »ç¹æŸ¥çœ‹
- ç†±é–€ URLï¼ˆ20% çš„ URL ä½” 80% æµé‡ï¼‰
- å¤šå¯¦ä¾‹éƒ¨ç½²

**æµé‡æŒ‡æ¨™ï¼š**

- æµé‡ï¼š> æ¯æ—¥ 50,000 æ¬¡é»æ“Šï¼ˆ~0.6 QPSï¼‰
- å³°å€¼ä¸¦ç™¼ï¼š> æ¯ç§’ 20 æ¬¡è«‹æ±‚

**æ•ˆèƒ½æå‡ï¼š**

- é‡å®šå‘æ™‚é–“ï¼š300ms â†’ 10-20ms
- è³‡æ–™åº«è² è¼‰ï¼šé™ä½ 70% åˆ° 90%
- å¯æ”¯æ’ 10-100 å€æµé‡
- ç™»å‡ºåœ¨æ‰€æœ‰å¯¦ä¾‹é–“åŒæ­¥

**æˆæœ¬ï¼š** ç´„ $15-25/æœˆï¼ˆæ•ˆèƒ½æå‡ 5-10 å€ï¼‰

### âš ï¸ **å¼·çƒˆå»ºè­°ä½¿ç”¨ Redisï¼ˆ> æ¯æ—¥ 100 è¬æ¬¡é»æ“Šï¼‰**

**å¿…è¦ä½¿ç”¨æ–¼ï¼š**

- SaaS ç”¢å“æˆ–é«˜æµé‡æœå‹™
- å¤šå¯¦ä¾‹æ­£å¼ç’°å¢ƒéƒ¨ç½²
- éœ€è¦ä¿è­‰é€Ÿç‡é™åˆ¶çš„æœå‹™

**æµé‡æŒ‡æ¨™ï¼š**

- æµé‡ï¼š> æ¯æ—¥ 1,000,000 æ¬¡é»æ“Šï¼ˆ~12 QPSï¼‰
- å³°å€¼ä¸¦ç™¼ï¼š> æ¯ç§’ 100 æ¬¡è«‹æ±‚

**ä¸ä½¿ç”¨ Redis çš„é¢¨éšªï¼š**

- è³‡æ–™åº«æˆç‚ºç“¶é ¸
- ç”¨æˆ¶é«”é©—ä¸‹é™
- é€Ÿç‡é™åˆ¶åƒ…é™å–®ä¸€å¯¦ä¾‹ï¼ˆéå…¨åŸŸï¼‰

### ğŸ“Š **å¦‚ä½•åˆ¤æ–·**

ç›£æ§é€™äº›æŒ‡æ¨™ï¼š

- **è³‡æ–™åº«æŸ¥è©¢æ™‚é–“** > 200ms â†’ è€ƒæ…®ä½¿ç”¨ Redis
- **é‡å®šå‘éŸ¿æ‡‰** > 500ms â†’ éœ€è¦å„ªåŒ–
- **ç›¸åŒ URL** æ¯å°æ™‚è¢«æŸ¥è©¢ > 10 æ¬¡ â†’ å¿«å–æœ‰å¹«åŠ©
- **å¤šå¯¦ä¾‹éƒ¨ç½²** â†’ éœ€è¦ Redis åŒæ­¥

### ğŸš€ **Railway éƒ¨ç½²**

**é¸é … Aï¼šä¸ä½¿ç”¨ Redisï¼ˆç°¡å–®ä¸”ä¾¿å®œï¼‰**

1. ä¸è¦æ–°å¢ Redis æœå‹™
2. ä¸è¦è¨­å®š `REDIS_HOST` ç’°å¢ƒè®Šæ•¸
3. ç³»çµ±ä½¿ç”¨è‡ªå‹•é™ç´š
4. æˆæœ¬ï¼šç´„ $5-10/æœˆ

**é¸é … Bï¼šä½¿ç”¨ Redisï¼ˆæ•ˆèƒ½ï¼‰**

1. åœ¨ Railway æ–°å¢ Redis æœå‹™
2. ç’°å¢ƒè®Šæ•¸è‡ªå‹•è¨­å®šï¼š
   ```
   REDIS_HOST=${{Redis.RAILWAY_PRIVATE_DOMAIN}}
   REDIS_PORT=${{Redis.REDISPORT}}
   REDIS_PASSWORD=${{Redis.REDISPASSWORD}}
   ```
3. ç³»çµ±è‡ªå‹•åµæ¸¬ä¸¦ä½¿ç”¨ Redis
4. æˆæœ¬ï¼šç´„ $15-25/æœˆ

**éš¨æ™‚åˆ‡æ›ï¼š** å¯éš¨æ™‚æ–°å¢æˆ–ç§»é™¤ Redisï¼Œç„¡éœ€ä¿®æ”¹ç¨‹å¼ç¢¼ã€‚ç³»çµ±æœƒè‡ªå‹•é©æ‡‰ã€‚

---

## å¿«é€Ÿé–‹å§‹

### ç³»çµ±éœ€æ±‚

- Node.js 18+
- PostgreSQL 14+
- Redis 6+ï¼ˆé¸ç”¨ï¼Œç”¨æ–¼å¿«å–ï¼‰

### å®‰è£æ­¥é©Ÿ

1. **è¤‡è£½å°ˆæ¡ˆ**

```bash
git clone https://github.com/supra126/open-short-url.git
cd open-short-url
```

2. **å®‰è£ç›¸ä¾å¥—ä»¶**

```bash
pnpm install
```

3. **è¨­å®šç’°å¢ƒè®Šæ•¸**

```bash
# å¾Œç«¯
cp apps/backend/.env.example apps/backend/.env.local
# ç·¨è¼¯ apps/backend/.env.localï¼Œå¡«å…¥æ‚¨çš„è³‡æ–™åº«æ†‘è­‰

# å‰ç«¯
cp apps/frontend/.env.example apps/frontend/.env.local
# ç·¨è¼¯ apps/frontend/.env.localï¼Œå¡«å…¥ API URL
# é¸ç”¨ï¼šè¨­å®š NEXT_PUBLIC_LOCALE=zh-TW ä½¿ç”¨ç¹é«”ä¸­æ–‡ï¼ˆé è¨­ç‚º enï¼‰
```

4. **è¨­å®šè³‡æ–™åº«**

```bash
cd apps/backend
pnpm prisma:migrate
pnpm prisma:seed
```

5. **å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨**

```bash
# å¾å°ˆæ¡ˆæ ¹ç›®éŒ„
pnpm dev
```

é–‹å•Ÿç¶²å€ï¼š

- å‰ç«¯ï¼šhttp://localhost:4100
- å¾Œç«¯ APIï¼šhttp://localhost:4101
- API æ–‡ä»¶ï¼šhttp://localhost:4101/api

é è¨­å¸³è™Ÿï¼š`admin@example.com` / `admin123`

---

## ğŸ¤– å…§å»º AI èŠå¤©åŠ©æ‰‹

ç›´æ¥åœ¨ç¶²é ä»‹é¢é€éå°è©±å¼ AI ç®¡ç†æ‚¨çš„çŸ­ç¶²å€ã€‚

### æ”¯æ´çš„ AI ä¾›æ‡‰å•†

- **Anthropic Claude**ï¼ˆclaude-3-5-sonnetã€claude-3-5-haiku ç­‰ï¼‰
- **OpenAI GPT**ï¼ˆgpt-4oã€gpt-4o-miniã€gpt-4-turbo ç­‰ï¼‰
- **Google Gemini**ï¼ˆgemini-2.0-flash-expã€gemini-1.5-pro ç­‰ï¼‰
- **Mistral**ï¼ˆmistral-large-latestã€mistral-medium ç­‰ï¼‰
- **Cohere**ï¼ˆcommand-r-plusã€command-r ç­‰ï¼‰

### è¨­å®šæ–¹å¼

åœ¨å¾Œç«¯ `.env.local` è¨­å®šç’°å¢ƒè®Šæ•¸ä¾†å•Ÿç”¨ AIï¼š

```bash
# é¸æ“‡æ‚¨çš„ AI ä¾›æ‡‰å•†
AI_PROVIDER=anthropic  # é¸é …ï¼šanthropicã€openaiã€googleã€mistralã€cohere

# Anthropic Claude
AI_MODEL=claude-3-5-sonnet-20241022
ANTHROPIC_API_KEY=sk-ant-your-api-key-here

# OpenAI GPT
AI_MODEL=gpt-4o
OPENAI_API_KEY=sk-your-api-key-here

# Google Gemini
AI_MODEL=gemini-2.0-flash-exp
GOOGLE_API_KEY=your-api-key-here

# Mistral
AI_MODEL=mistral-large-latest
MISTRAL_API_KEY=your-api-key-here

# Cohere
AI_MODEL=command-r-plus
COHERE_API_KEY=your-api-key-here
```

### åŠŸèƒ½ç‰¹è‰²

- ğŸ—£ï¸ **è‡ªç„¶èªè¨€ä»‹é¢**ï¼šé€éå°è©±æ–¹å¼ç®¡ç†ç¶²å€
- ğŸ”§ **è‡ªå‹•åŒ–æ“ä½œ**ï¼šä½¿ç”¨ç°¡å–®æŒ‡ä»¤å»ºç«‹ã€æ›´æ–°ã€åˆªé™¤ç¶²å€
- ğŸ“Š **åˆ†ææŸ¥è©¢**ï¼šè©¢å•é»æ“Šçµ±è¨ˆèˆ‡æ•ˆèƒ½æ•¸æ“š
- ğŸ§ª **A/B æ¸¬è©¦ç®¡ç†**ï¼šè¨­å®šèˆ‡ç®¡ç†ç¶²å€è®Šé«”
- ğŸ“ **çµ„åˆæ•´ç†**ï¼šå»ºç«‹èˆ‡ç®¡ç†é€£çµé›†åˆ
- ğŸŒ **å¤šèªè¨€**ï¼šå®Œæ•´æ”¯æ´è‹±æ–‡èˆ‡ç¹é«”ä¸­æ–‡

### å­˜å–è·¯å¾‘

è¨­å®šå®Œæˆå¾Œï¼Œå¯å­˜å– AI åŠŸèƒ½ï¼š

- **AI èŠå¤©**ï¼š`/ai-chat` - å°è©±å¼ç¶²å€ç®¡ç†ä»‹é¢
- **AI è¨­å®š**ï¼š`/ai-settings` - è¨­å®šæŒ‡å—èˆ‡ç‹€æ…‹å„€è¡¨æ¿

### ç¯„ä¾‹æŒ‡ä»¤

- ã€Œå¹«æˆ‘å»ºç«‹ https://example.com çš„çŸ­ç¶²å€ï¼ŒçŸ­ç¢¼è¨­ç‚º 'promo'ã€
- ã€Œé¡¯ç¤ºæœ¬é€±å»ºç«‹çš„æ‰€æœ‰ç¶²å€ã€
- ã€Œé»æ“Šé‡æœ€é«˜çš„å‰ 5 å€‹ç¶²å€æ˜¯å“ªäº›ï¼Ÿã€
- ã€Œå¹«æˆ‘å»ºç«‹ä¸€å€‹å¤å­£æ´»å‹•çš„ Bundleã€
- ã€Œè¨­å®š A/B æ¸¬è©¦ï¼Œæµé‡åˆ†é… 60/40ã€

---

## ğŸ¤– AI åŠ©æ‰‹æ•´åˆï¼ˆMCPï¼‰

é€é Model Context Protocol (MCP) æ•´åˆï¼Œä½¿ç”¨ AI åŠ©æ‰‹ç®¡ç†æ‚¨çš„çŸ­ç¶²å€ã€‚

### ä»€éº¼æ˜¯ MCPï¼Ÿ

[Model Context Protocol](https://modelcontextprotocol.io) æ˜¯ä¸€å€‹é–‹æ”¾æ¨™æº–ï¼Œè®“ AI æ‡‰ç”¨èƒ½å¤ å®‰å…¨åœ°é€£æ¥åˆ°å¤–éƒ¨å·¥å…·å’Œè³‡æ–™ä¾†æºã€‚æˆ‘å€‘çš„ MCP server è®“ Claude Desktopã€Cursorã€Windsurf ç­‰ AI åŠ©æ‰‹èƒ½é€éè‡ªç„¶å°è©±ç®¡ç†æ‚¨çš„çŸ­ç¶²å€ã€‚

### å®‰è£

å…¨åŸŸå®‰è£ MCP serverï¼š

```bash
npm install -g @open-short-url/mcp
```

### è¨­å®š

åœ¨æ‚¨çš„ MCP å®¢æˆ¶ç«¯ï¼ˆä¾‹å¦‚ Claude Desktopï¼‰ä¸­è¨­å®šï¼š

```json
{
  "mcpServers": {
    "open-short-url": {
      "command": "open-short-url-mcp",
      "env": {
        "API_URL": "https://your-backend.com",
        "API_KEY": "ak_your_api_key_here"
      }
    }
  }
}
```

### æ‚¨å¯ä»¥åšä»€éº¼

è¨­å®šå®Œæˆå¾Œï¼Œæ‚¨å¯ä»¥è«‹ AI åŠ©æ‰‹ï¼š

- ã€Œå¹«æˆ‘å»ºç«‹ https://example.com çš„çŸ­ç¶²å€ï¼Œè‡ªè¨‚çŸ­ç¢¼ç‚º 'promo'ã€
- ã€Œé¡¯ç¤ºæœ¬æœˆæ‰€æœ‰çš„çŸ­ç¶²å€ã€
- ã€Œå¹«æˆ‘ç”ŸæˆçŸ­ç¶²å€ abc123 çš„ QR Codeã€
- ã€Œæˆ‘çš„æ´»å‹•ç¶²å€é»æ“Šçµ±è¨ˆå¦‚ä½•ï¼Ÿã€
- ã€Œå»ºç«‹ä¸€å€‹å«ã€å¤å­£æ´»å‹•ã€çš„ Bundleï¼Œä¸¦åŠ å…¥é€™äº›ç¶²å€...ã€
- ã€Œè¨­å®š A/B æ¸¬è©¦ï¼Œæµé‡å„åˆ†é… 50%ã€

### å¯ç”¨åŠŸèƒ½

MCP server æä¾› 29 å€‹å·¥å…·ï¼Œæ¶µè“‹ï¼š

- URL ç®¡ç†ï¼ˆå»ºç«‹ã€åˆ—è¡¨ã€æ›´æ–°ã€åˆªé™¤ã€QR Codeï¼‰
- Bundle ç®¡ç†ï¼ˆçµ„ç¹”ç¶²å€ç‚ºé›†åˆï¼‰
- åˆ†æåŠŸèƒ½ï¼ˆè©³ç´°é»æ“Šè¿½è¹¤èˆ‡çµ±è¨ˆï¼‰
- A/B æ¸¬è©¦ï¼ˆå»ºç«‹èˆ‡ç®¡ç†ç¶²å€è®Šé«”ï¼‰

### äº†è§£æ›´å¤š

- ğŸ“¦ [MCP Server å¥—ä»¶](https://www.npmjs.com/package/@open-short-url/mcp)
- ğŸ“– [MCP Server æ–‡ä»¶](./packages/mcp/README.zh-TW.md)
- ğŸŒ [Model Context Protocol](https://modelcontextprotocol.io)

---

## ä½¿ç”¨æ¡ˆä¾‹

### ä¼æ¥­æ‡‰ç”¨

- å»ºç«‹å“ç‰ŒåŒ–çŸ­é€£çµé€²è¡Œè¡ŒéŠ·æ´»å‹•
- é€éè©³ç´°åˆ†æè¿½è¹¤æ´»å‹•æˆæ•ˆ
- å¯†ç¢¼ä¿è­·æ©Ÿå¯†é€£çµ
- è·¨é€šè·¯ç¶­æŒå“ç‰Œä¸€è‡´æ€§

### é–‹ç™¼è€…

- è‡ªæ¶è§£æ±ºæ–¹æ¡ˆï¼Œå®Œæ•´ API å­˜å–æ¬Š
- é€é REST API èˆ‡ç¾æœ‰ç³»çµ±æ•´åˆ
- è‡ªè¨‚èˆ‡æ“´å……åŠŸèƒ½
- ç„¡ä¾›æ‡‰å•†é–å®š

### éš±ç§å€¡è­°è€…

- å®Œå…¨çš„è³‡æ–™æ‰€æœ‰æ¬Š
- ç„¡ç¬¬ä¸‰æ–¹è¿½è¹¤
- GDPR åˆè¦
- é–‹æºé€æ˜

---

## é€£çµçµ„åˆ

é€éé€£çµçµ„åˆåŠŸèƒ½é«˜æ•ˆçµ„ç¹”èˆ‡ç®¡ç†æ‚¨çš„ç¶²å€ã€‚

### åŠŸèƒ½ç‰¹è‰²

- **è¦–è¦ºåŒ–çµ„ç¹”**ï¼šè‰²å½©ç·¨ç¢¼çš„çµ„åˆèˆ‡è‡ªè¨‚åœ–ç¤ºï¼ˆ16 å€‹é è¨­è¡¨æƒ…ç¬¦è™Ÿï¼‰
- **ç´¯è¨ˆåˆ†æ**ï¼š
  - çµ„åˆå…§æ‰€æœ‰ç¶²å€çš„ç¸½é»æ“Šæ•¸
  - ç¶²å€æ•¸é‡èˆ‡åˆ†å¸ƒ
  - è­˜åˆ¥è¡¨ç¾æœ€ä½³çš„ç¶²å€
  - 7 å¤©é»æ“Šè¶¨å‹¢è¦–è¦ºåŒ–
- **å½ˆæ€§ç®¡ç†**ï¼š
  - å‹•æ…‹æ–°å¢/ç§»é™¤ç¶²å€
  - è‡ªè¨‚çµ„åˆå…§ç¶²å€çš„æ’åº
  - å°å­˜é–’ç½®çš„çµ„åˆ
  - æœå°‹èˆ‡ç¯©é¸åŠŸèƒ½
- **æ‰¹æ¬¡æ“ä½œ**ï¼š
  - ä¸€æ¬¡æ–°å¢å¤šå€‹ç¶²å€
  - å»ºç«‹çµ„åˆæ™‚åŒæ™‚åŠ å…¥ç¶²å€
  - è·¨ä¸åŒçµ„åˆç®¡ç†ç¶²å€

### ä½¿ç”¨æ¡ˆä¾‹

- **è¡ŒéŠ·æ´»å‹•**ï¼šå°‡æ‰€æœ‰æ´»å‹•ç¶²å€åˆ†çµ„ä»¥çµ±ä¸€è¿½è¹¤
- **ç”¢å“ç™¼å¸ƒ**ï¼šä¾ç”¢å“æˆ–åŠŸèƒ½çµ„ç¹”ç¶²å€
- **ç¤¾ç¾¤åª’é«”**ï¼šä¾å¹³å°æ•´ç†ç¶²å€
- **å®¢æˆ¶å°ˆæ¡ˆ**ï¼šä¾å®¢æˆ¶æˆ–å°ˆæ¡ˆåˆ†é¡ç¶²å€
- **å­£ç¯€æ€§å…§å®¹**ï¼šçµ„ç¹”æœ‰æ™‚æ•ˆæ€§çš„ç¶²å€

### çµ±è¨ˆè¿½è¹¤

æ¯å€‹çµ„åˆæä¾›ï¼š

- ç¸½é»æ“Šæ•¸ï¼ˆæ‰€æœ‰ç¶²å€çš„ç¸½å’Œï¼‰
- ç¶²å€æ•¸é‡
- è¡¨ç¾æœ€ä½³çš„ç¶²å€
- 7 å¤©é»æ“Šè¶¨å‹¢åœ–è¡¨
- å„ç¶²å€çš„æ•ˆèƒ½æŒ‡æ¨™

---

## Webhook é©—è­‰æŒ‡å—

Open Short URL ä½¿ç”¨ **HMAC-SHA256** ç°½åæ©Ÿåˆ¶ç¢ºä¿ webhook å‚³é€çš„å®‰å…¨æ€§ã€‚æ¥æ”¶ç«¯å¿…é ˆé©—è­‰ç°½åä»¥ç¢ºä¿è«‹æ±‚ä¾†è‡ªæ‚¨çš„ä¼ºæœå™¨ã€‚

### ğŸ“‹ é©—è­‰æ­¥é©Ÿ

ç³»çµ±æœƒåœ¨æ¯å€‹ webhook è«‹æ±‚çš„ `X-Webhook-Signature` header ä¸­åŒ…å« HMAC-SHA256 ç°½åã€‚ä»¥ä¸‹æ˜¯é©—è­‰ç¯„ä¾‹ï¼š

```javascript
const crypto = require('crypto');
const express = require('express');

function verifyWebhookSignature(request, secret) {
  // 1. å¾ header å–å¾—ç°½å
  const receivedSignature = request.headers['x-webhook-signature'];

  // 2. è®€å–åŸå§‹ request bodyï¼ˆå¿…é ˆæ˜¯å®Œæ•´çš„ JSON å­—ç¬¦ä¸²ï¼‰
  const payload = JSON.stringify(request.body);

  // 3. ä½¿ç”¨ç›¸åŒçš„ secret å’Œæ¼”ç®—æ³•é‡æ–°è¨ˆç®—ç°½å
  const expectedSignature = crypto
    .createHmac('sha256', secret)
    .update(payload)
    .digest('hex');

  // 4. ä½¿ç”¨æ™‚é–“å®‰å…¨çš„æ¯”è¼ƒæ–¹æ³•ï¼ˆé˜²æ­¢æ™‚åºæ”»æ“Šï¼‰
  return crypto.timingSafeEqual(
    Buffer.from(receivedSignature, 'hex'),
    Buffer.from(expectedSignature, 'hex')
  );
}

// Express.js ä½¿ç”¨ç¯„ä¾‹
const app = express();

app.post('/webhook', express.json(), (req, res) => {
  const secret = process.env.WEBHOOK_SECRET; // æ‚¨è¨­å®šçš„ webhook secret

  // é©—è­‰ç°½å
  if (!verifyWebhookSignature(req, secret)) {
    return res.status(401).json({ error: 'Invalid signature' });
  }

  // å–å¾—äº‹ä»¶è³‡è¨Š
  const event = req.headers['x-webhook-event'];
  const deliveryId = req.headers['x-webhook-delivery-id'];
  const attempt = req.headers['x-webhook-attempt'];

  // è™•ç† webhook äº‹ä»¶
  console.log('Event:', event);
  console.log('Delivery ID:', deliveryId);
  console.log('Attempt:', attempt);
  console.log('Data:', req.body.data);

  // å›æ‡‰æˆåŠŸï¼ˆ2xx ç‹€æ…‹ç¢¼ï¼‰
  res.status(200).json({ received: true });
});

app.listen(3000);
```

### âš ï¸ é‡è¦æ³¨æ„äº‹é …

1. **JSON åºåˆ—åŒ–æ–¹å¼**
   - å¿…é ˆä½¿ç”¨èˆ‡ç™¼é€ç«¯ç›¸åŒçš„ JSON åºåˆ—åŒ–æ–¹å¼ï¼ˆç„¡ç©ºæ ¼ï¼‰
   - ä½¿ç”¨ `JSON.stringify()` æ™‚ä¸è¦æ·»åŠ æ ¼å¼åŒ–åƒæ•¸

2. **åŸå§‹ Request Body**
   - ä½¿ç”¨åŸå§‹ bodyï¼šé©—è­‰å‰ä¸è¦ä¿®æ”¹ request body
   - ç¢ºä¿ body parser æ­£ç¢ºè™•ç† JSON

3. **æ™‚é–“å®‰å…¨æ¯”è¼ƒ**
   - ä½¿ç”¨ `crypto.timingSafeEqual()` é˜²æ­¢æ™‚åºæ”»æ“Š
   - ä¸è¦ä½¿ç”¨ `===` æˆ– `==` æ¯”è¼ƒç°½å

4. **å…¶ä»– Headers**
   - `X-Webhook-Event`: äº‹ä»¶é¡å‹ï¼ˆå¦‚ `url.created`ã€`url.clicked`ï¼‰
   - `X-Webhook-Delivery-Id`: å‚³é€ IDï¼ˆå¯ç”¨æ–¼å†ªç­‰æ€§æª¢æŸ¥ï¼Œé¿å…é‡è¤‡è™•ç†ï¼‰
   - `X-Webhook-Attempt`: é‡è©¦æ¬¡æ•¸ï¼ˆ1-3ï¼Œç³»çµ±æœƒè‡ªå‹•é‡è©¦å¤±æ•—çš„å‚³é€ï¼‰

5. **å›æ‡‰è¦æ±‚**
   - å¿…é ˆåœ¨ 10 ç§’å…§å›æ‡‰
   - å›æ‡‰ 2xx ç‹€æ…‹ç¢¼è¡¨ç¤ºæˆåŠŸ
   - é 2xx ç‹€æ…‹ç¢¼æœƒè§¸ç™¼é‡è©¦æ©Ÿåˆ¶ï¼ˆæœ€å¤š 3 æ¬¡ï¼‰

### ğŸ“¦ Payload çµæ§‹

#### **url.created / url.updated / url.deleted**

```json
{
  "event": "url.created",
  "timestamp": "2025-10-21T02:05:16.123Z",
  "data": {
    "urlId": "clxxx123456789",
    "slug": "abc123",
    "originalUrl": "https://example.com",
    "userId": "user123"
  }
}
```

#### **url.clicked**

```json
{
  "event": "url.clicked",
  "timestamp": "2025-10-21T02:05:16.123Z",
  "data": {
    "urlId": "clxxx123456789",
    "slug": "abc123",
    "targetUrl": "https://example.com/landing-page",
    "variantId": "variant_id",
    "variantName": "Variant A",
    "clickData": {
      "ip": "1.2.3.4",
      "userAgent": "Mozilla/5.0...",
      "referer": "https://google.com",
      "browser": "Chrome",
      "os": "Windows",
      "device": "Desktop",
      "country": "TW",
      "isBot": false,
      "utmSource": "newsletter",
      "utmMedium": "email",
      "utmCampaign": "summer_sale",
      "utmTerm": "keyword",
      "utmContent": "header_link"
    }
  }
}
```

**æ³¨æ„ï¼š**

- `timestamp`: é»æ“Šç™¼ç”Ÿçš„æº–ç¢ºæ™‚é–“ï¼ˆISO 8601 æ ¼å¼ï¼‰
- `targetUrl`: å¯¦éš›è·³è½‰çš„ç›®æ¨™ URLï¼ˆå¦‚æœæ˜¯ A/B æ¸¬è©¦ï¼Œæœƒæ˜¯é¸ä¸­çš„è®Šé«” URLï¼‰
- `variantId` å’Œ `variantName`: å¦‚æœæ˜¯ A/B æ¸¬è©¦ä¸”é¸ä¸­è®Šé«”ï¼ŒæœƒåŒ…å«é€™äº›æ¬„ä½ï¼›å¦‚æœé¸ä¸­æ§åˆ¶çµ„ï¼ˆåŸå§‹ URLï¼‰ï¼Œå‰‡ç‚º `null`
- `clickData.browser/os/device`: å¾ User-Agent è§£æè€Œä¾†
- `clickData.country`: å¾ IP åœ°å€è§£æè€Œä¾†ï¼ˆåœ‹å®¶ä»£ç¢¼ï¼‰
- `clickData.isBot`: æ˜¯å¦ç‚ºæ©Ÿå™¨äººæµé‡

### ğŸ¯ æ”¯æ´çš„äº‹ä»¶é¡å‹

- `url.created` - æ–°å¢çŸ­ç¶²å€æ™‚è§¸ç™¼
- `url.updated` - æ›´æ–°çŸ­ç¶²å€æ™‚è§¸ç™¼
- `url.deleted` - åˆªé™¤çŸ­ç¶²å€æ™‚è§¸ç™¼
- `url.clicked` - çŸ­ç¶²å€è¢«é»æ“Šæ™‚è§¸ç™¼
- `webhook.test` - æ¸¬è©¦ webhook æ™‚è§¸ç™¼

---

## æŠ€è¡“æ¶æ§‹

- **å¾Œç«¯**ï¼šNestJSã€Prismaã€PostgreSQLã€Redisï¼ˆé¸ç”¨ï¼‰
- **å‰ç«¯**ï¼šNext.js 16ã€React 19ã€TypeScriptã€Tailwind CSSã€TanStack Query
- **å®‰å…¨æ€§**ï¼šJWTã€bcryptã€Cloudflare Turnstile
- **åˆ†æ**ï¼šå³æ™‚é»æ“Šè¿½è¹¤èˆ‡åœ°ç†è³‡æ–™ã€æ©Ÿå™¨äººåµæ¸¬
- **è¦–è¦ºåŒ–**ï¼šRecharts è³‡æ–™è¦–è¦ºåŒ–
- **AI æ•´åˆ**ï¼šModel Context Protocol (MCP) serverï¼Œæ”¯æ´ AI åŠ©æ‰‹ç›¸å®¹æ€§

---

## é–‹ç™¼è·¯ç·šåœ–

- [ ] æ™ºæ…§æ¢ä»¶å¼è·¯ç”± (ä¾è£ç½®ã€åœ°å€ã€æ™‚é–“æ¢ä»¶é‡å°å‘)
- [ ] Open Graph / ç¤¾ç¾¤é è¦½è‡ªè¨‚
- [ ] æ·±åº¦é€£çµ (App Links / Universal Links)
- [ ] Retargeting Pixel æ•´åˆ

---

## æˆæ¬Š

æœ¬å°ˆæ¡ˆæ¡ç”¨ MIT æˆæ¬Š - è©³è¦‹ [LICENSE](LICENSE) æª”æ¡ˆã€‚

---

## æ”¯æ´

- ğŸ› [å•é¡Œè¿½è¹¤](https://github.com/supra126/open-short-url/issues)
